# 볼링 점수판

## 프로그래밍 요구사항

객체지향 생활 체조 원칙을 지키면서 프로그래밍한다.

### 객체지향 생활 체조 원칙

- 규칙 1: 한 메서드에 오직 한 단계의 들여쓰기만 한다.
- 규칙 2: else 예약어를 쓰지 않는다.
- 규칙 3: 모든 원시값과 문자열을 포장한다.
- 규칙 4: 한 줄에 점을 하나만 찍는다.
- 규칙 5: 줄여쓰지 않는다(축약 금지).
- 규칙 6: 모든 엔티티를 작게 유지한다.
- 규칙 7: 3개 이상의 인스턴스 변수를 가진 클래스를 쓰지 않는다.
- 규칙 8: 일급 콜렉션을 쓴다.
- 규칙 9: 게터/세터/프로퍼티를 쓰지 않는다.

### 이전 단계에서 적용했던 규칙

- 자바 8의 스트림과 람다를 적용해 프로그래밍한다.
- 예외 처리를 통해 에러가 발생하지 않도록 한다.
- 모든 기능을 TDD로 구현해 단위 테스트가 존재해야 한다. 단, UI(System.out, System.in) 로직은 제외
- java enum을 적용해 프로그래밍을 구현한다.
- 함수(또는 메소드)의 길이가 15라인을 넘어가지 않도록 구현한다.
- 자바 코드 컨벤션을 지키면서 프로그래밍한다.

### 힌트

- 객체 단위를 극단적으로 분리하도록 시도해본다.
- 1 ~ 9 프레임을 NormalFrame, 10 프레임을 FinalFrame과 같은 구조로 구현한 후 Frame을 추가해 중복을 제거해 본다.
- 다음 Frame을 현재 Frame 외부에서 생성하기 보다 현재 Frame에서 다음 Frame을 생성하는 방식으로 구현해 보고, 어느 구현이 더 좋은지 검토해 본다.

## 기능 요구사항

- 1단계: 볼링 게임 점수판만 구현하기
- 각 프레임이 스트라이크이면 "X", 스페어이면 "9|/", 미스이면 "8|1", 거터면 "-"과 같이 출력하도록 구현한다.
    - Enum을 활용해보면 좋겠다.
    - 스트라이크(strike): 첫번째 투구에서 모든 핀(10개)을 쓰러트린 상태 "X"로 표기
    - 스페어(spare): 프레임의 두번째 투구에서 모든 핀(10개)을 쓰러트린 상태
        - 표기는 "첫번째 투구의 개수|/"로 표기한다.
    - 미스(miss): 프레임의 두번째 투구에서도 모든 핀이 쓰러지지 않은 상태
        - 표기는 "첫번째 투구의 개수|두번쨰 투구의 개수"로 표기한다.
    - 거터(gutter): 핀을 하나도 쓰러트리지 못한 상태. 거터는 "-"로 표시한다.
- 10 프레임은 스트라이크이거나 스페어이면 한 번 더 투구할 수 있다.

## TODO

- [x] 사용자 이름 입력받기
    - [x] 사용자 이름 검증하기
        - [x] 사용자 이름 Validation 실패와 관련된 예외
            - [x] 1 ~ 3자
            - [x] 영문 대소문자
    - [x] 아마도~ 추후에 선수별 점수계산이 들어가는 경우를 생각해볼 수 있지 않을까?
        - [x] 선수가 이름과 프레임목록을 가지는 형태로 구현해보자.
- [x] 프레임 생성하기
    - [x] 라운드 번호를 가진다.
        - [x] 포장을 이용해서 유효성 검증을 한다.
            - [x] 0보다 크고, 11보다 작다.
        - [x] 첫번째 라운드 번호를 생성하는 기능을 가진다.
    - [x] 핀의 개수와 프레임의 상태를 관리하는 FrameScore를 가지고 있는다.
        - [x] 기본생성자로 생성시 핀은 10개, FrameStatus는 NONE이다.
        - [x] 프레임이 가진 핀의 개수를 가진다.
            - [x] 최초 핀은 10개다. 포장을 이용해서 유효성 검증을 한다.
        - [x] 프레임의 상태를 관리한다.
            - [x] 프레임의 상태를 나타내는 FrameStatus Enum 생성
                - [x] Strike
                - [x] Spare
                - [x] miss
                - [x] gutter
                - [x] 상태는 모든 핀이 쓰러지거나, 모든 투구가 종료된 후 결정된다.
                - [x] 어떻게 투구 결과로 Enum을 만들지 고민.
    - [x] 10프레임은 특수한 경우이므로 따로 관리한다.
        - [x] 만약, 10 프레임 실행결과가 스트라이크, 스페어라면 추가 기회 1회가 주어진다. (최대 2회)
            - [x] 스트라이크는 10 프레임에서 3회까지 던질 수 있다.(퍼펙트 게임)
        - [x] 다른 자료를 찾아보니 스트라이크를 3회 던질 수 있다. <https://www.bowlinggenius.com/> 리뷰어님께 확인요청을 드렸다.
- [x] 투구를 입력받는 기능 구현하기
    - [x] 이 역시 핀을 이용해서 검증한다.
- [x] 프레임을 출력하는 코드 작성하기
    - [x] 프레임의 번호를 알 수 있어야 한다.
    - [x] 프레임의 상태를 출력해야한다.
    - [x] 사용자 이름을 출력할 수 있어야 한다.
- [x] `Frame`을 추상클래스로 두고, `NormalFrame`과 `FinalFrame`으로 나눈다.
    - [x] 공통으로 제공할 메서드를 `Frame`에 둔다.
        - [x] 다음 프레임의 생성
        - [x] 투구 수행
        - [x] 마지막 프레임인지 확인
    - [x] `NormalFrame`에 첫번째 프레임을 생성하는 기능을 추가한다.
- [x] `Pin`의 목록을 관리하는 클래스를 정의한다.
    - [x] 기본적으로 두 개의 Pin을 관리하는 `NormalPins`
    - [x] 마지막 Frame에서 사용되는 `FinalPins` 가 있다.
- [x] `Pins`를 이용해 FrameScore를 개선한다.
    - [x] FrameScore는 `Pins` 와 `FrameStatus`를 가진다.
    - [x] FrameScore는 해당 프레임이 종료되었는지 확인하는 메서드를 가져야한다.
- [x] Frame이 종료되었는지 확인하는 기능을 구현한다.
    - [x] FrameScore: FrameStatus가 NOT_ENDED인가?
    - [x] Frame: FrameScore 호출
    - [x] Frames: 해당 Frame 호출
    - [x] Player: Frame 번호를 넘겨준다.
- [ ] 투구 기능을 구현한다.
    - [x] Pins: 쓰러진 Pin의 개수를 전달하고, 새로운 Pins를 반환한다.
    - [x] FrameScore: Pins에 쓰러진 핀의 개수를 전달한다. 새로운 FrameScore를 반환한다.
    - [x] Frame: FrameScore에 쓰러진 핀의 개수를 전달한다. FrameScore를 교체한다.(불변 포기)
    - [x] Frames: 해당 Frame에 쓰러진 핀의 개수를 전달한다.
    - [x] Player: 쓰러진 핀의 개수를 입력받는다.
    - [x] 투구가 불가능한 경우 예외를 반환한다.
- [x] FinalFrame 개선
    - [x] 출력부분이 너무 똥이다.
        - [x] 출력은 Output 쪽에 위임하고 싶은데... 고민...
    - [x] Frame이라는 추상클래스에 얽매여서 구현이 고통스러워지는 부분이 없잖아 있는 것 같다.
        - [x] FrameScore도 제거가 가능한게 아닐까?
- [ ] 요구사항 준수했는지 확인
    - [x] 1 뎁스
    - [x] else 사용 금지, 삼항 연산자 사용 금지
    - [x] 모든 원시값과 문자열 포장
    - [ ] 한 줄에 점 하나만 찍기
    - [x] 축약 금지
    - [ ] 모든 엔티티를 작게 유지한다.
    - [ ] 3개 이상의 인스턴스 변수를 가진 클래스 사용 금지
        - `Frame`은 객체 분리를 시도할지 고민입니다.
    - [x] 일급 콜렉션 사용
    - [x] 게터/세터/프로퍼티 사용 금지
    - [x] 스트림/람다 활용
    - [x] 예외 처리를 통해 에러 발생 방지
    - [x] TDD로 구현한다. (UI) 로직 제외
    - [x] Enum을 활용해 구현한다. (이전단계에서 가져와서 필수가 아닐 수 있음)
    - [x] 함수의 길이가 15라인을 넘어가지 않도록 구현한다.
    - [x] 자바 코드 컨벤션을 지키면서 프로그래밍

## 개선할 사항

- [x] Normal Frame에서 10개를 초과한 핀을 쓰러뜨릴 수 있음. (투구가 불가능한 경우 예외 반환)
- [x] 프레임이 종료되지 않았더라도 상태가 출력되어야 함.
- [x] Pins 개선 -> List Collection으로 구현하면 어떨까?
- [x] Frame이 다음 Frame을 알고있는 구조로 구현을 해보자.

## 리뷰 내용 정리

- [x] 테스트의 이름을 조건 -> 수행 -> 결과의 형태로 바꿔보자.
- [x] 여러 핀을 쓰러뜨리는 상황을 테스트해보자.
- [x] FinalFrameTest에서 마지막 프레임이 맞는지를 테스트해보자.
- [x] 테스트에서만 사용하는 함수는 다른 방식으로 검증하거나, 제거하자.
- [x] 뷰와 연관된 구현은 뷰 패키지로 분리해서 뷰 객체로 만들어 사용해보자.
    - 힌트
        - FrameStatusView - 한 프레임의 상태를 표현한다.
        - GameStatus - Frames 객체를 소유하고 있으며 FrameStatusView로 변환 및 전체 상태를 View로 변환하는 책임을 가진다.
        - FrameHeadView - 프레임의 목록을 표현한다. (아마 Head를 출력하는 부분을 말씀하신듯)
- [x] 있을 수 없는 경우의 테스트를 피하자.
- [x] TestFixture의 사용을 검토해보자. 혹은 테스트 코드를 바로 읽기좋게 사용해보자.
- [x] given / when / then의 구조에 신경 써 보자.
- [x] FrameScore를 받는 인수를 변경해보자.
- [x] 양방향 의존성을 제거해보자.

## 3단계 요구사항 정리

- [ ] 점수를 계산한다.
- [ ] 각 프레임의 점수는 합산되는 방식으로 자세한 내용은 볼링 규칙을 참고한다.
- [ ] 일반 투구는 점수가 프레임이 종료된 후 반영된다.
- [ ] 스트라이크는 다음 2회 투구의 점수가 함께 반영된다.
- [ ] 스페어는 다음 1회 투구의 점수가 함께 반영된다.
- [ ] 10 프레임의 경우에는 추가 투구횟수가 없으므로 핀의 개수의 합이 점수가 된다.
- [ ] Frame이 점수 계산의 주체가 되도록 개발한다.
- [ ] 객체지향 5원칙을 지키면서 프로그래밍한다.
    - [ ] SRP
    - [ ] OCP
    - [ ] LSP
    - [ ] ISP
    - [ ] DIP
    - 이것을 지킨 코딩에 대해서 고민해보자.

## 리뷰 내용 정리

- [x] `Frames#initialize`와 `Frames#value`의 중복 코드 제거(Frame을 미리 만들지 않는 식으로 개선해보면 어떨까?)
- [ ] `FrameStatusViewTest`를 DCI 패턴으로 구조화 해보자.
    - [ ] X/8/ 처럼 나머지가 일반구로 처리되어야 하는 경우에 대한 테스트를 추가하자.
- [ ] `pins#knockDownPin`에서 `validate`를 수행하는 것이 더 OOP에 맞다. (결국 객체를 분리해야 한다.)
    - [ ] 추상클래스로 추출해서, `validate` 부분을 Override하는 식으로 개발하면 되겠다.
- [ ] `Pin`에 `isGutter` 메서드 추가하기
    - [ ] `Pin`에 `status()` 부분은 `isGutter`를 추가하면서 View쪽으로 옮긴다.
